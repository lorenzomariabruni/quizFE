<div class="container">
  <div class="card quiz-creation-card">
    <!-- Header -->
    <div class="header-section">
      <h1 class="main-title">
        <span class="icon">‚úèÔ∏è</span> Crea Nuovo Quiz
      </h1>
      <p class="subtitle" *ngIf="!quizCreated">Compila le informazioni per iniziare</p>
      <p class="subtitle" *ngIf="quizCreated">Condividi il QR code per aggiungere domande</p>
    </div>

    <!-- Status Messages -->
    <div *ngIf="error" class="alert alert-error" role="alert">
      <span class="alert-icon">‚ö†Ô∏è</span>
      <span>{{ error }}</span>
    </div>

    <div *ngIf="success" class="alert alert-success" role="alert">
      <span class="alert-icon">‚úÖ</span>
      <span>{{ success }}</span>
    </div>

    <!-- Step 1: Create Quiz -->
    <div *ngIf="!quizCreated" class="step-section">
      <div class="step-header">
        <span class="step-number">1</span>
        <h2>Informazioni Quiz</h2>
      </div>
      
      <form class="form-section">
        <div class="form-group">
          <label for="quizName" class="form-label required">Nome Quiz (ID):</label>
          <input 
            id="quizName"
            type="text" 
            [(ngModel)]="quizName"
            name="quizName"
            placeholder="es: quiz-storia-2024"
            class="form-input"
            [class.input-error]="error && !quizName.trim()"
            maxlength="50"
          />
          <small class="form-hint">Identificatore univoco (solo lettere, numeri, trattini e underscore)</small>
        </div>

        <div class="form-group">
          <label for="quizTitle" class="form-label required">Titolo:</label>
          <input 
            id="quizTitle"
            type="text" 
            [(ngModel)]="quizTitle"
            name="quizTitle"
            placeholder="es: Quiz di Storia - Seconda Guerra Mondiale"
            class="form-input"
            [class.input-error]="error && !quizTitle.trim()"
            maxlength="100"
          />
          <small class="form-hint">Nome descrittivo che verr√† mostrato agli utenti</small>
        </div>

        <div class="form-group">
          <label for="quizDescription" class="form-label">Descrizione (opzionale):</label>
          <textarea 
            id="quizDescription"
            [(ngModel)]="quizDescription"
            name="quizDescription"
            placeholder="Breve descrizione del contenuto del quiz..."
            rows="3"
            class="form-input"
            maxlength="500"
          ></textarea>
          <small class="form-hint">Aiuta gli utenti a capire il contenuto del quiz</small>
        </div>
      </form>

      <div class="action-buttons">
        <button type="button" class="btn btn-secondary" (click)="goBack()">
          <span>‚Üê Annulla</span>
        </button>
        <button 
          type="button"
          class="btn btn-primary" 
          (click)="createQuiz()" 
          [disabled]="loading || !quizName.trim() || !quizTitle.trim()">
          <span>{{ loading ? '‚è≥ Creazione...' : 'Continua ‚Üí' }}</span>
        </button>
      </div>
    </div>

    <!-- Step 2: QR Code and Counter -->
    <div *ngIf="quizCreated" class="qr-section">
      <!-- Quiz Info -->
      <div class="quiz-info-box">
        <h2 class="quiz-title-display">üéÆ {{ quizTitle }}</h2>
        <p *ngIf="quizDescription" class="quiz-description-display">{{ quizDescription }}</p>
      </div>

      <!-- QR Code -->
      <div class="qr-code-container">
        <div class="qr-code-wrapper">
          <img [src]="qrCodeUrl" alt="QR Code" class="qr-code-image" />
        </div>
        <p class="qr-instruction">üì± Scansiona per aggiungere domande</p>
        <p class="qr-url">{{ addQuestionUrl }}</p>
      </div>

      <!-- Question Counter -->
      <div class="counter-section">
        <div class="counter-display">
          <div class="counter-number">{{ questionCount }}</div>
          <div class="counter-label">{{ questionCount === 1 ? 'Domanda Aggiunta' : 'Domande Aggiunte' }}</div>
        </div>
        <div class="counter-animation">
          <div class="pulse-ring"></div>
        </div>
      </div>

      <!-- Info Box -->
      <div class="info-box">
        <p class="info-text">
          <span class="info-icon">üí°</span>
          Il contatore si aggiorna automaticamente ogni volta che viene aggiunta una domanda da qualsiasi dispositivo.
        </p>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button type="button" class="btn btn-secondary" (click)="goBack()">
          <span>‚Üê Annulla</span>
        </button>
        <button 
          type="button"
          class="btn btn-primary btn-large" 
          (click)="finishQuiz()">
          <span>‚úÖ Completa Quiz</span>
        </button>
      </div>
    </div>
  </div>
</div>